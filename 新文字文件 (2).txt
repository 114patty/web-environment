#!/bin/bash
APP_DIR="/home/utl/Desktop/web-environment-main"
GIT_DIR="/opt/update.git"

echo ">>> 部署開始..." >> /home/utl/deploy.log

git --work-tree=$APP_DIR --git-dir=$GIT_DIR checkout -f >> /home/utl/deploy.log 2>&1

sudo systemctl restart flask.service >> /home/utl/deploy.log 2>&1

echo ">>> 部署完成！" >> /home/utl/deploy.log

-----------------------------------------------

#!/bin/bash
WORK_TREE=/opt/web_app/web_app.py
GIT_DIR=/opt/update.git

# 把最新程式碼 checkout 出來
git --work-tree=$WORK_TREE --git-dir=$GIT_DIR checkout -f main

# 切到專案目錄
cd $WORK_TREE

# 重新啟動 Flask 與 Node.js (用 systemd)
sudo systemctl restart flask.service
sudo systemctl restart node.service
